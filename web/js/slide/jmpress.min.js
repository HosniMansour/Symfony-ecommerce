!function(e,t,a,s){function r(e){if(e){var t=1+e.substr(1).search(/[A-Z]/),a=e.substr(0,t).toLowerCase(),s=e.substr(t).toLowerCase();return"-"+a+"-"+s}}function n(e){return e?e+",":""}function i(r){function n(t,a){var s=u(t),r={oldStyle:e(t).attr("style")||""},n={data:s,stepData:r};p.call(this,"beforeInitStep",e(t),n),r.delegate=s.delegate,p.call(this,"initStep",e(t),n),e(t).data("stepData",r),e(t).attr("id")||e(t).attr("id","step-"+(a+1)),p.call(this,"applyStep",e(t),n)}function i(t){var a=e(t).data("stepData");e(t).attr("style",a.oldStyle),p.call(this,"unapplyStep",e(t),{stepData:a})}function o(t){p.call(this,"unapplyStep",e(t),{stepData:t.data("stepData")}),p.call(this,"applyStep",e(t),{stepData:t.data("stepData")})}function l(){_&&p.call(this,"setInactive",_,{stepData:e(_).data("stepData"),reason:"deinit"}),Y.jmpressClass&&e(A).removeClass(Y.jmpressClass),p.call(this,"beforeDeinit",e(this),{}),e(I.stepSelector,A).each(function(){i.call(A,this)}),z.attr("style",k.container),I.fullscreen&&e("html").attr("style",""),Z.attr("style",k.area),e(X).children().each(function(){A.append(e(this))}),I.fullscreen?X.remove():(X.remove(),Z.remove()),p.call(this,"afterDeinit",e(this),{}),e(A).data("jmpressmethods",!1)}function p(t,a,s){s.settings=I,s.current=Y,s.container=z,s.parents=a?h(a):null,s.current=Y,s.jmpress=this;var r={};return e.each(I[t],function(e,t){r.value=t.call(A,a,s)||r.value}),r.value}function f(){if(_){var t=e(_).near(I.stepSelector).add(e(_).near(I.stepSelector,!0)).add(p.call(this,"selectPrev",_,{stepData:e(_).data("stepData")})).add(p.call(this,"selectNext",_,{stepData:e(_).data("stepData")}));t.each(function(){var t=this;e(t).hasClass(I.loadedClass)||setTimeout(function(){e(t).hasClass(I.loadedClass)||(p.call(A,"loadStep",t,{stepData:e(t).data("stepData")}),e(t).addClass(I.loadedClass))},I.transitionDuration-100)}),e(_).hasClass(I.loadedClass)||(p.call(A,"loadStep",_,{stepData:e(_).data("stepData")}),e(_).addClass(I.loadedClass))}}function h(t){for(var a=[],s=t;e(s).parent().length&&e(s).parent().is(I.stepSelector);)s=e(s).parent(),a.push(s[0]);return a}function v(e){return g({step:_,substep:O},e)}function g(t,a){var r;if(e.isPlainObject(t)&&(r=t.substep,t=t.step),"string"==typeof t&&(t=A.find(t).first()),!t||!e(t).data("stepData"))return!1;b.call(this);var n=e(t).data("stepData"),i=!1;if(p.call(this,"beforeChange",t,{stepData:n,reason:a,cancel:function(){i=!0}}),i)return s;var o={},l=t;e(t).data("stepData").delegate&&(l=e(t).parentsUntil(A).filter(I.stepSelector).filter(n.delegate)||e(t).near(n.delegate)||e(t).near(n.delegate,!0)||e(n.delegate,A),n=l.data("stepData")),F&&p.call(this,"setInactive",F,{stepData:e(F).data("stepData"),delegatedFrom:_,reason:a,target:o,nextStep:l,nextSubstep:r,nextStepData:n});var c={stepData:n,delegatedFrom:t,reason:a,target:o,substep:r,prevStep:F,prevSubstep:O,prevStepData:F&&e(F).data("stepData")};return p.call(this,"beforeActive",l,c),p.call(this,"setActive",l,c),Y.jmpressClass&&e(A).removeClass(Y.jmpressClass),e(A).addClass(Y.jmpressClass="step-"+e(l).attr("id")),Y.jmpressDelegatedClass&&e(A).removeClass(Y.jmpressDelegatedClass),e(A).addClass(Y.jmpressDelegatedClass="delegating-step-"+e(t).attr("id")),p.call(this,"applyTarget",_,e.extend({canvas:X,area:Z},c)),_=t,O=c.substep,F=l,f.call(this),l}function b(){function t(){function s(){(0!==e(z).scrollTop()||0!==e(z).scrollLeft())&&t()}"BODY"===e(z)[0].tagName&&a.scrollTo(0,0),e(z).scrollTop(0),e(z).scrollLeft(0),setTimeout(s,1),setTimeout(s,10),setTimeout(s,100),setTimeout(s,200),setTimeout(s,400)}t()}function y(e){return g.call(this,e,"jump")}function j(){return g.call(this,p.call(this,"selectNext",_,{stepData:e(_).data("stepData"),substep:O}),"next")}function D(){return g.call(this,p.call(this,"selectPrev",_,{stepData:e(_).data("stepData"),substep:O}),"prev")}function S(){return g.call(this,p.call(this,"selectHome",_,{stepData:e(_).data("stepData")}),"home")}function w(){return g.call(this,p.call(this,"selectEnd",_,{stepData:e(_).data("stepData")}),"end")}function C(t){return c(X,t||{}),e(X)}function x(){return F&&e(F)}function M(t,a,s){m[t]?p.call(this,t,a,s):e.error("callback "+t+" is not registered.")}function P(){var e=navigator.userAgent.toLowerCase(),t=-1===e.search(/(iphone)|(ipod)|(android)/);return t}r=e.extend(!0,{},r||{});var T={},N=null;for(N in m)T[N]=e.isFunction(r[N])?[r[N]]:r[N],r[N]=[];var I=e.extend(!0,{},d,r);for(N in m)T[N]&&Array.prototype.push.apply(I[N],T[N]);var A=e(this),z=null,Z=null,k={container:"",area:""},X=null,Y=null,_=!1,O=null,F=!1;if(A.data("jmpressmethods",{select:g,reselect:v,scrollFix:b,goTo:y,next:j,prev:D,home:S,end:w,canvas:C,container:function(){return z},settings:function(){return I},active:x,current:function(){return Y},fire:M,deinit:l,reapply:o}),P()===!1)return void(I.notSupportedClass&&A.addClass(I.notSupportedClass));I.notSupportedClass&&A.removeClass(I.notSupportedClass);var Q=e(I.stepSelector,A);z=A,Z=e("<div />"),X=e("<div />"),e(A).children().filter(Q).each(function(){X.append(e(this))}),I.fullscreen&&(z=e("body"),e("html").css({overflow:"hidden"}),Z=A),k.area=Z.attr("style")||"",k.container=z.attr("style")||"",I.fullscreen?(z.css({height:"100%"}),A.append(X)):(z.css({position:"relative"}),Z.append(X),A.append(Z)),e(z).addClass(I.containerClass),e(Z).addClass(I.areaClass),e(X).addClass(I.canvasClass),t.documentElement.style.height="100%",z.css({overflow:"hidden"});var W={position:"absolute",transitionDuration:"0s"};W=e.extend({},I.animation,W),c(Z,W),c(Z,{top:"50%",left:"50%",perspective:"1000px"}),c(X,W),Y={},p.call(this,"beforeInit",null,{}),Q.each(function(e){n.call(A,this,e)}),p.call(this,"afterInit",null,{}),g.call(this,p.call(this,"selectInitialStep","init",{})),I.initClass&&e(Q).removeClass(I.initClass)}function o(){return d}function l(t,a){e.isFunction(a)?v[t]?e.error("function "+t+" is already registered."):v[t]=a:m[t]?e.error("callback "+t+" is already registered."):(m[t]=1,d[t]=[])}function c(t,a){var s,r,n={};for(s in a)a.hasOwnProperty(s)&&(r=f(s),null!==r&&(n[r]=a[s]));return e(t).css(n),t}function u(t){function a(e){e=e.split("-");for(var t=1;t<e.length;t++)e[t]=e[t].substr(0,1).toUpperCase()+e[t].substr(1);return e.join("")}if(e(t)[0].dataset)return e.extend({},e(t)[0].dataset);var s={},r=e(t)[0].attributes;return e.each(r,function(e,t){"data-"===t.nodeName.substr(0,5)&&(s[a(t.nodeName.substr(5))]=t.nodeValue)}),s}function p(){return!!e(this).data("jmpressmethods")}var f=function(){var e=t.createElement("dummy").style,a="Webkit Moz O ms Khtml".split(" "),r={};return function(t){if("undefined"==typeof r[t]){var n=t.charAt(0).toUpperCase()+t.substr(1),i=(t+" "+a.join(n+" ")+n).split(" ");r[t]=null;for(var o in i)if(e[i[o]]!==s){r[t]=i[o];break}}return r[t]}}(),d={stepSelector:".step",containerClass:"",canvasClass:"",areaClass:"",notSupportedClass:"",loadedClass:"loaded",fullscreen:!0,animation:{transformOrigin:"top left",transitionProperty:n(r(f("transform")))+n(r(f("perspective")))+"opacity",transitionDuration:"1s",transitionDelay:"500ms",transitionTimingFunction:"ease-in-out",transformStyle:"preserve-3d"},transitionDuration:1500,test:!1},m={beforeChange:1,beforeInitStep:1,initStep:1,beforeInit:1,afterInit:1,beforeDeinit:1,afterDeinit:1,applyStep:1,unapplyStep:1,setInactive:1,beforeActive:1,setActive:1,selectInitialStep:1,selectPrev:1,selectNext:1,selectHome:1,selectEnd:1,loadStep:1,applyTarget:1};for(var h in m)d[h]=[];var v={init:i,initialized:p,deinit:function(){},css:c,pfx:f,defaults:o,register:l,dataset:u};e.fn.jmpress=function(t){function a(){var a=e(this).data("jmpressmethods");if(a&&a[t]){if("_"!==t.substr(0,1)||a.settings().test!==!1)return a[t].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+t+" is protected and should only be used internally.")}else if(v[t]){if("_"!==t.substr(0,1)||d.test!==!1)return v[t].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+t+" is protected and should only be used internally.")}else if(m[t]&&a){var s=a.settings(),r=Array.prototype.slice.call(arguments,1)[0];e.isFunction(r)&&(s[t]=s[t]||[],s[t].push(r))}else{if("object"==typeof t||!t)return i.apply(this,arguments);e.error("Method "+t+" does not exist on jQuery.jmpress")}return this}var s,r=arguments;return e(this).each(function(e,t){s=a.apply(t,r)}),s},e.extend({jmpress:function(t){if(v[t]){if("_"!==t.substr(0,1)||d.test!==!1)return v[t].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+t+" is protected and should only be used internally.")}else if(m[t]){var a=Array.prototype.slice.call(arguments,1)[0];e.isFunction(a)?d[t].push(a):e.error("Second parameter should be a function: $.jmpress( callbackName, callbackFunction )")}else e.error("Method "+t+" does not exist on jQuery.jmpress")}})}(jQuery,document,window),function(e){function t(t,a,s,r){var n;return t.each(function(t,i){return r&&(n=a(i,s,r))?!1:e(i).is(s)?(n=i,!1):!r&&(n=a(i,s,r))?!1:void 0}),n}function a(s,r,n){var i=e(s).children();return n&&(i=e(i.get().reverse())),t(i,a,r,n)}function s(s,r,n){return t(e(s)[n?"prevAll":"nextAll"](),a,r,n)}function r(t,a,r){var n,i=e(t).parents();return i=e(i.get()),e.each(i.get(),function(t,i){return r&&e(i).is(a)?(n=i,!1):(n=s(i,a,r),n?!1:void 0)}),n}e.fn.near=function(t,n){var i=[];return e(this).each(function(e,o){var l=(n?!1:a(o,t,n))||s(o,t,n)||r(o,t,n);l&&i.push(l)}),e(i)}}(jQuery,document,window),function(e,t,a,s){function r(e){return Math.round(1e4*e)/1e4+""}var n={3:{transform:function(t,a){var s="translate(-50%,-50%)";e.each(a,function(e,t){var a,n=["X","Y","Z"];if("translate"===t[0])s+=" translate3d("+r(t[1]||0)+"px,"+r(t[2]||0)+"px,"+r(t[3]||0)+"px)";else if("rotate"===t[0]){var i=t[4]?[1,2,3]:[3,2,1];for(a=0;3>a;a++)s+=" rotate"+n[i[a]-1]+"("+r(t[i[a]]||0)+"deg)"}else if("scale"===t[0])for(a=0;3>a;a++)s+=" scale"+n[a]+"("+r(t[a+1]||1)+")"}),e.jmpress("css",t,e.extend({},{transform:s}))}},2:{transform:function(t,a){var s="translate(-50%,-50%)";e.each(a,function(e,t){var a=["X","Y"];if("translate"===t[0])s+=" translate("+r(t[1]||0)+"px,"+r(t[2]||0)+"px)";else if("rotate"===t[0])s+=" rotate("+r(t[3]||0)+"deg)";else if("scale"===t[0])for(var n=0;2>n;n++)s+=" scale"+a[n]+"("+r(t[n+1]||1)+")"}),e.jmpress("css",t,e.extend({},{transform:s}))}},1:{transform:function(t,a){var s={top:0,left:0};e.each(a,function(e,t){"translate"===t[0]&&(s.left=Math.round(t[1]||0)+"px",s.top=Math.round(t[2]||0)+"px")}),t.animate(s,1e3)}}},i=function(){return e.jmpress("pfx","perspective")?n[3]:e.jmpress("pfx","transform")?n[2]:n[1]}();e.jmpress("defaults").reasonableAnimation={},e.jmpress("initStep",function(t,a){var s=a.data,r=a.stepData,n=parseFloat;e.extend(r,{x:n(s.x)||0,y:n(s.y)||0,z:n(s.z)||0,r:n(s.r)||0,phi:n(s.phi)||0,rotate:n(s.rotate)||0,rotateX:n(s.rotateX)||0,rotateY:n(s.rotateY)||0,rotateZ:n(s.rotateZ)||0,revertRotate:!1,scale:n(s.scale)||1,scaleX:n(s.scaleX)||!1,scaleY:n(s.scaleY)||!1,scaleZ:n(s.scaleZ)||1})}),e.jmpress("afterInit",function(t,a){var s=a.settings.stepSelector,r=a.current;r.perspectiveScale=1,r.maxNestedDepth=0;for(var n=e(a.jmpress).find(s).children(s);n.length;)r.maxNestedDepth++,n=n.children(s)}),e.jmpress("applyStep",function(t,a){e.jmpress("css",e(t),{position:"absolute",transformStyle:"preserve-3d"}),a.parents.length>0&&e.jmpress("css",e(t),{top:"50%",left:"50%"});var s=a.stepData,r=[["translate",s.x||s.r*Math.sin(s.phi*Math.PI/180),s.y||-s.r*Math.cos(s.phi*Math.PI/180),s.z],["rotate",s.rotateX,s.rotateY,s.rotateZ||s.rotate,!0],["scale",s.scaleX||s.scale,s.scaleY||s.scale,s.scaleZ||s.scale]];i.transform(t,r)}),e.jmpress("setActive",function(t,a){var r=a.target,n=a.stepData,i=r.transform=[];r.perspectiveScale=1;for(var o=a.current.maxNestedDepth;o>(a.parents.length||0);o--)i.push(["scale"],["rotate"],["translate"]);i.push(["scale",1/(n.scaleX||n.scale),1/(n.scaleY||n.scale),1/n.scaleZ]),i.push(["rotate",-n.rotateX,-n.rotateY,-(n.rotateZ||n.rotate)]),i.push(["translate",-(n.x||n.r*Math.sin(n.phi*Math.PI/180)),-(n.y||-n.r*Math.cos(n.phi*Math.PI/180)),-n.z]),r.perspectiveScale*=n.scaleX||n.scale,e.each(a.parents,function(t,a){var s=e(a).data("stepData");i.push(["scale",1/(s.scaleX||s.scale),1/(s.scaleY||s.scale),1/s.scaleZ]),i.push(["rotate",-s.rotateX,-s.rotateY,-(s.rotateZ||s.rotate)]),i.push(["translate",-(s.x||s.r*Math.sin(s.phi*Math.PI/180)),-(s.y||-s.r*Math.cos(s.phi*Math.PI/180)),-s.z]),r.perspectiveScale*=s.scaleX||s.scale}),e.each(i,function(e,t){function r(r){a.current["rotate"+r+"-"+e]===s&&(a.current["rotate"+r+"-"+e]=t[r]||0);var n=a.current["rotate"+r+"-"+e],i=t[r]||0,o=n%360,l=i%360;0>o&&(o+=360),0>l&&(l+=360);var c=l-o;-180>c?c+=360:c>180&&(c-=360),a.current["rotate"+r+"-"+e]=t[r]=n+c}"rotate"===t[0]&&(r(1),r(2),r(3))})}),e.jmpress("applyTarget",function(t,a){var s,r=a.target,n=(a.stepData,a.settings),o=1.3*r.perspectiveScale<a.current.perspectiveScale,l=r.perspectiveScale>1.3*a.current.perspectiveScale,c=-1;e.each(r.transform,function(e,t){return t.length<=1||"rotate"===t[0]&&t[1]%360===0&&t[2]%360===0&&t[3]%360===0?void 0:"scale"!==t[0]?!1:void(c=e)}),c!==a.current.oldLastScale&&(o=l=!1,a.current.oldLastScale=c);var u=[];if(-1!==c)for(;c>=0;)"scale"===r.transform[c][0]&&(u.push(r.transform[c]),r.transform[c]=["scale"]),c--;var p=n.animation;n.reasonableAnimation[a.reason]&&(p=e.extend({},p,n.reasonableAnimation[a.reason])),s={perspective:Math.round(1e3*r.perspectiveScale)+"px"},s=e.extend({},p,s),o||(s.transitionDelay="0s"),t||(s.transitionDuration="0s",s.transitionDelay="0s"),e.jmpress("css",a.area,s),i.transform(a.area,u),s=e.extend({},p),l||(s.transitionDelay="0s"),t||(s.transitionDuration="0s",s.transitionDelay="0s"),a.current.perspectiveScale=r.perspectiveScale,e.jmpress("css",a.canvas,s),i.transform(a.canvas,r.transform)})}(jQuery,document,window),function(e){"use strict";var t=e.jmpress,a="activeClass",s="nestedActiveClass",r=t("defaults");r[s]="nested-active",r[a]="active",t("setInactive",function(t,r){var n=r.settings,i=n[a],o=n[s];i&&e(t).removeClass(i),o&&e.each(r.parents,function(t,a){e(a).removeClass(o)})}),t("setActive",function(t,r){var n=r.settings,i=n[a],o=n[s];i&&e(t).addClass(i),o&&e.each(r.parents,function(t,a){e(a).addClass(o)})})}(jQuery,document,window),function(e){function t(t,a){return e(this).find(a.settings.stepSelector).first()}function a(t,a,s,r){if(!a)return!1;var n=s.settings.stepSelector;a=e(a);do{var i=a.near(n,r);if((0===i.length||0===i.closest(t).length)&&(i=e(t).find(n)[r?"last":"first"]()),!i.length)return!1;a=i}while(a.data("stepData").exclude);return a}var s=e.jmpress;s("initStep",function(e,t){t.stepData.exclude=t.data.exclude&&-1===["false","no"].indexOf(t.data.exclude)}),s("selectInitialStep",t),s("selectHome",t),s("selectEnd",function(t,a){return e(this).find(a.settings.stepSelector).last()}),s("selectPrev",function(e,t){return a(this,e,t,!0)}),s("selectNext",function(e,t){return a(this,e,t)})}(jQuery,document,window),function(e){e.jmpress("selectInitialStep",function(e,t){return t.settings.start})}(jQuery,document,window),function(e){function t(t,a,s){for(var r=0;r<a.length-1;r++){var n=a[r],i=a[r+1];e(n,t).attr("data-"+s,i)}}function a(t,a,s,r){var n=a.stepData;if(n[s]){var i=e(t).near(n[s],r);if(i&&i.length)return i;if(i=e(n[s],this)[r?"last":"first"](),i&&i.length)return i}}var s=e.jmpress;s("register","route",function(e,a,s){"string"==typeof e&&(e=[e,e]),t(this,e,s?"prev":"next"),a||t(this,e.reverse(),s?"next":"prev")}),s("initStep",function(e,t){for(var a in{next:1,prev:1})t.stepData[a]=t.data[a]}),s("selectNext",function(e,t){return a(e,t,"next")}),s("selectPrev",function(e,t){return a(e,t,"prev",!0)})}(jQuery,document,window),function(e){var t=e.jmpress,a="afterStepLoaded";t("register",a),t("initStep",function(t,a){a.stepData.src=e(t).attr("href")||a.data.src||!1}),t("loadStep",function(t,s){var r=s.stepData,n=r&&r.src;n&&e(t).load(n,function(r,n,i){e(s.jmpress).jmpress("fire",a,t,e.extend({},s,{response:r,status:n,xhr:i}))})})}(jQuery,document,window),function(e,t,a,s){function r(){return""+Math.round(1e5*Math.random(),0)}function n(t){try{var r=e("#"+a.location.hash.replace(/^#\/?/,""));return r.length>0&&r.is(t.stepSelector)?r:s}catch(n){}}var i=e.jmpress,o="a[href^=#]";i("defaults").hash={use:!0,update:!0,bindChange:!0},i("selectInitialStep",function(t,s){var i=s.settings,l=i.hash,c=s.current,u=e(this);return s.current.hashNamespace=".jmpress-"+r(),l.use?(l.bindChange&&(e(a).bind("hashchange"+c.hashNamespace,function(){var e=n(i);if(u.jmpress("initialized")&&u.jmpress("scrollFix"),e&&e.length){e.attr("id")!==u.jmpress("active").attr("id")&&u.jmpress("select",e);var t="#/"+e.attr("id");a.location.hash!==t&&(a.location.hash=t)}}),e(o).on("click"+c.hashNamespace,function(t){var a=e(this).attr("href");try{e(a).is(i.stepSelector)&&(u.jmpress("select",a),t.preventDefault(),t.stopPropagation())}catch(s){}})),n(i)):void 0}),i("afterDeinit",function(t,s){e(o).off(s.current.hashNamespace),e(a).unbind(s.current.hashNamespace)}),i("setActive",function(t,s){var r=s.settings,n=s.current;r.hash.use&&r.hash.update&&(clearTimeout(n.hashtimeout),n.hashtimeout=setTimeout(function(){a.location.hash="#/"+e(s.delegatedFrom).attr("id")},r.transitionDuration+200))})}(jQuery,document,window),function(e,t,a,s){function r(){return""+Math.round(1e5*Math.random(),0)}function n(e){e.preventDefault(),e.stopPropagation()}var i=e.jmpress,o="next",l="prev";i("defaults").keyboard={use:!0,keys:{33:l,37:l,38:l,9:o+":"+l,32:o,34:o,39:o,40:o,36:"home",35:"end"},ignore:{INPUT:[32,37,38,39,40],TEXTAREA:[32,37,38,39,40],SELECT:[38,40]},tabSelector:"a[href]:visible, :input:visible"},i("afterInit",function(a,i){var o=i.settings,l=o.keyboard,c=l.ignore,u=i.current,p=e(this);o.fullscreen||p.attr("tabindex",0),u.keyboardNamespace=".jmpress-"+r(),e(o.fullscreen?t:p).bind("keypress"+u.keyboardNamespace,function(e){for(var t in c)if(e.target.nodeName===t&&-1!==c[t].indexOf(e.which))return;(e.which>=37&&e.which<=40||32===e.which)&&n(e)}),e(o.fullscreen?t:p).bind("keydown"+u.keyboardNamespace,function(t){var a=e(t.target);if((o.fullscreen||a.closest(p).length)&&l.use){for(var r in c)if(a[0].nodeName===r&&-1!==c[r].indexOf(t.which))return;var i,u=!1;if(9===t.which){if(a.closest(p.jmpress("active")).length?(i=a.near(l.tabSelector,t.shiftKey),e(i).closest(o.stepSelector).is(p.jmpress("active"))||(i=s)):t.shiftKey?u=!0:i=p.jmpress("active").find("a[href], :input").filter(":visible").first(),i&&i.length>0)return i.focus(),p.jmpress("scrollFix"),n(t),void 0;t.shiftKey&&(u=!0)}var f=l.keys[t.which];"string"==typeof f?(-1!==f.indexOf(":")&&(f=f.split(":"),f=t.shiftKey?f[1]:f[0]),p.jmpress(f),n(t)):e.isFunction(f)?f.call(p,t):f&&(p.jmpress.apply(p,f),n(t)),u&&(i=p.jmpress("active").find("a[href], :input").filter(":visible").last(),i.focus(),p.jmpress("scrollFix"))}})}),i("afterDeinit",function(a,s){e(t).unbind(s.current.keyboardNamespace)})}(jQuery,document,window),function(e,t,a,s){function r(){return""+Math.round(1e5*Math.random(),0)}function n(e,t){return Math.max(Math.min(e,t),-t)}function i(t,a,s){var r=e(this).jmpress("current"),i=e(this).jmpress("settings"),o=e(this).jmpress("active").data("stepData"),l=e(this).jmpress("container");if(!(0===r.userZoom&&0>s)){var c=o.viewPortZoomable||i.viewPort.zoomable;if(!(r.userZoom===c&&s>0)){r.userZoom+=s;var u=e(l).innerWidth()/2,p=e(l).innerHeight()/2;t=t?t-u:t,a=a?a-p:a,r.userTranslateX=n(r.userTranslateX-s*t/r.zoomOriginWindowScale/c,u*r.userZoom*r.userZoom/c),r.userTranslateY=n(r.userTranslateY-s*a/r.zoomOriginWindowScale/c,p*r.userZoom*r.userZoom/c),e(this).jmpress("reselect","zoom")}}}var o=e.jmpress("defaults");o.viewPort={width:!1,height:!1,maxScale:0,minScale:0,zoomable:0,zoomBindMove:!0,zoomBindWheel:!0};var l=o.keyboard.keys;l[e.browser.mozilla?107:187]="zoomIn",l[e.browser.mozilla?109:189]="zoomOut",o.reasonableAnimation.resize={transitionDuration:"0s",transitionDelay:"0ms"},o.reasonableAnimation.zoom={transitionDuration:"0s",transitionDelay:"0ms"},e.jmpress("initStep",function(e,t){for(var a in{viewPortHeight:1,viewPortWidth:1,viewPortMinScale:1,viewPortMaxScale:1,viewPortZoomable:1})t.stepData[a]=t.data[a]&&parseFloat(t.data[a])}),e.jmpress("afterInit",function(n,i){var o=this;i.current.viewPortNamespace=".jmpress-"+r(),e(a).bind("resize"+i.current.viewPortNamespace,function(){e(o).jmpress("reselect","resize")}),i.current.userZoom=0,i.current.userTranslateX=0,i.current.userTranslateY=0,i.settings.viewPort.zoomBindWheel&&e(i.settings.fullscreen?t:this).bind("mousewheel"+i.current.viewPortNamespace,function(t,a){a=a||t.originalEvent.wheelDelta;var s=a/Math.abs(a);0>s?e(i.jmpress).jmpress("zoomOut",t.originalEvent.x,t.originalEvent.y):s>0&&e(i.jmpress).jmpress("zoomIn",t.originalEvent.x,t.originalEvent.y)}),i.settings.viewPort.zoomBindMove&&e(i.settings.fullscreen?t:this).bind("mousedown"+i.current.viewPortNamespace,function(e){i.current.userZoom&&(i.current.userTranslating={x:e.clientX,y:e.clientY},e.preventDefault(),e.stopImmediatePropagation())}).bind("mousemove"+i.current.viewPortNamespace,function(t){var a=i.current.userTranslating;a&&(e(o).jmpress("zoomTranslate",t.clientX-a.x,t.clientY-a.y),a.x=t.clientX,a.y=t.clientY,t.preventDefault(),t.stopImmediatePropagation())}).bind("mouseup"+i.current.viewPortNamespace,function(e){i.current.userTranslating&&(i.current.userTranslating=s,e.preventDefault(),e.stopImmediatePropagation())})}),e.jmpress("register","zoomIn",function(e,t){i.call(this,e||0,t||0,1)}),e.jmpress("register","zoomOut",function(e,t){i.call(this,e||0,t||0,-1)}),e.jmpress("register","zoomTranslate",function(t,a){var s=e(this).jmpress("current"),r=e(this).jmpress("settings"),i=e(this).jmpress("active").data("stepData"),o=e(this).jmpress("container"),l=i.viewPortZoomable||r.viewPort.zoomable,c=e(o).innerWidth(),u=e(o).innerHeight();s.userTranslateX=n(s.userTranslateX+t/s.zoomOriginWindowScale,c*s.userZoom*s.userZoom/l),s.userTranslateY=n(s.userTranslateY+a/s.zoomOriginWindowScale,u*s.userZoom*s.userZoom/l),e(this).jmpress("reselect","zoom")}),e.jmpress("afterDeinit",function(t,s){e(a).unbind(s.current.viewPortNamespace)}),e.jmpress("setActive",function(t,a){var s=a.settings.viewPort,r=a.stepData.viewPortHeight||s.height,n=a.stepData.viewPortWidth||s.width,i=a.stepData.viewPortMaxScale||s.maxScale,o=a.stepData.viewPortMinScale||s.minScale,l=r&&e(a.container).innerHeight()/r,c=n&&e(a.container).innerWidth()/n,u=(c||l)&&Math.min(c||l,l||c);if(u){u=u||1,i&&(u=Math.min(u,i)),o&&(u=Math.max(u,o));var p=a.stepData.viewPortZoomable||a.settings.viewPort.zoomable;if(p){var f=1/u-1/i;f/=p,u=1/(1/u-f*a.current.userZoom)}a.target.transform.reverse(),a.current.userTranslateX&&a.current.userTranslateY?a.target.transform.push(["translate",a.current.userTranslateX,a.current.userTranslateY,0]):a.target.transform.push(["translate"]),a.target.transform.push(["scale",u,u,1]),a.target.transform.reverse()}a.current.zoomOriginWindowScale=u}),e.jmpress("setInactive",function(t,a){a.nextStep&&t&&e(a.nextStep).attr("id")===e(t).attr("id")||(a.current.userZoom=0,a.current.userTranslateX=0,a.current.userTranslateY=0)})}(jQuery,document,window),function(e){function t(){return""+Math.round(1e5*Math.random(),0)}var a=e.jmpress;a("defaults").mouse={clickSelects:!0},a("afterInit",function(a,s){var r=s.settings,n=r.stepSelector,i=s.current,o=e(this);i.clickableStepsNamespace=".jmpress-"+t(),o.bind("click"+i.clickableStepsNamespace,function(t){if(r.mouse.clickSelects&&!i.userZoom){var a=e(t.target).closest(n);a.is(o.jmpress("active"))||a.length&&(o.jmpress("select",a[0],"click"),t.preventDefault(),t.stopPropagation())}})}),a("afterDeinit",function(t,a){e(this).unbind(a.current.clickableStepsNamespace)})}(jQuery,document,window),function(e,t){function a(){return""+Math.round(1e5*Math.random(),0)}var s=e.jmpress;s("afterInit",function(s,r){var n=r.settings,i=r.current,o=r.jmpress;i.mobileNamespace=".jmpress-"+a();var l,c=[0,0];e(n.fullscreen?t:o).bind("touchstart"+i.mobileNamespace,function(e){l=e.originalEvent.touches[0],c=[l.pageX,l.pageY]}).bind("touchmove"+i.mobileNamespace,function(e){return l=e.originalEvent.touches[0],e.preventDefault(),!1}).bind("touchend"+i.mobileNamespace,function(t){var a=[l.pageX,l.pageY],s=[a[0]-c[0],a[1]-c[1]];return Math.max(Math.abs(s[0]),Math.abs(s[1]))>50?(s=Math.abs(s[0])>Math.abs(s[1])?s[0]:s[1],e(o).jmpress(s>0?"prev":"next"),t.preventDefault(),!1):void 0})}),s("afterDeinit",function(a,s){var r=s.settings,n=s.current,i=s.jmpress;e(r.fullscreen?t:i).unbind(n.mobileNamespace)})}(jQuery,document,window),function(e,t,a,s){function r(t,a,n){for(var i in a){var o=i;n&&(o=n+o.substr(0,1).toUpperCase()+o.substr(1)),e.isPlainObject(a[i])?r(t,a[i],o):t[o]===s&&(t[o]=a[i])}}function n(t,a){e.isArray(a)?a.length<t.length?e.error("more nested steps than children in template"):t.each(function(t,s){s=e(s);var n=s.data(c)||{};r(n,a[t]),s.data(c,n)}):e.isFunction(a)&&t.each(function(s,n){n=e(n);var i=n.data(c)||{};r(i,a(s,n,t)),n.data(c,i)})}function i(e,t,a,s){if(a.children){var r=t.children(s.settings.stepSelector);n(r,a.children)}o(e,a)}function o(e,t){r(e,t)}var l=e.jmpress,c="_template_",u="_applied_template_",p={};l("beforeInitStep",function(t,a){t=e(t);var s=a.data,r=s.template,n=t.data(u),o=t.data(c);r&&e.each(r.split(" "),function(e,r){var n=p[r];i(s,t,n,a)}),n&&i(s,t,n,a),o&&(i(s,t,o,a),t.data(c,null),o.template&&e.each(o.template.split(" "),function(e,r){var n=p[r];i(s,t,n,a)}))}),l("beforeInit",function(t,a){var s=l("dataset",this),r=s.template,i=a.settings.stepSelector;if(r){var o=p[r];n(e(this).find(i).filter(function(){return!e(this).parent().is(i)}),o.children)}}),l("register","template",function(t,a){p[t]?p[t]=e.extend(!0,{},p[t],a):p[t]=e.extend(!0,{},a)}),l("register","apply",function(t,a){if(a)if(e.isArray(a))n(e(t),a);else{var s;s="string"==typeof a?p[a]:e.extend(!0,{},a),e(t).each(function(t,a){a=e(a);var n=a.data(u)||{};r(n,s),a.data(u,n)})}else{var i=e(this).jmpress("settings").stepSelector;n(e(this).find(i).filter(function(){return!e(this).parent().is(i)}),t)}})}(jQuery,document,window),function(e){e.jmpress("setActive",function(t,a){a.prevStep!==t&&e(t).triggerHandler("enterStep")}),e.jmpress("setInactive",function(t,a){a.nextStep!==t&&e(t).triggerHandler("leaveStep")})}(jQuery,document,window),function(e,t,a,s){function r(t){for(var a=t.split(" "),s=a[0],r={willClass:"will-"+s,doClass:"do-"+s,hasClass:"has-"+s},n="",i=1;i<a.length;i++){var o=a[i];switch(n){case"":"after"===o?n="after":e.warn("unknown keyword in '"+t+"'. '"+o+"' unknown.");break;case"after":if(o.match(/^[1-9][0-9]*m?s?/)){var l=parseFloat(o);-1!==o.indexOf("ms")?l*=1:-1!==o.indexOf("s")?l*=1e3:-1!==o.indexOf("m")&&(l*=6e4),r.delay=l}else r.after=Array.prototype.slice.call(a,i).join(" ")}}return r}function n(t,a,s,r){r=r||t.length-1,s=s||0;for(var n=s;r+1>n;n++)if(e(t[n].element).is(a))return n}function i(t,a,s){e.each(a._on,function(e,a){t.push({substep:a.substep,delay:a.delay+s}),i(t,a.substep,a.delay+s)})}e.jmpress("defaults").customAnimationDataAttribute="jmpress",e.jmpress("afterInit",function(e,t){t.current.animationTimeouts=[],t.current.animationCleanupWaiting=[]}),e.jmpress("applyStep",function(t,a){function o(e,t){return t.substep._after?(u=t.substep._after,!1):void 0}var l={},c=[];if(e(t).find("[data-"+a.settings.customAnimationDataAttribute+"]").each(function(s,r){e(r).closest(a.settings.stepSelector).is(t)&&c.push({element:r})}),0!==c.length){e.each(c,function(t,s){s.info=r(e(s.element).data(a.settings.customAnimationDataAttribute)),e(s.element).addClass(s.info.willClass),s._on=[],s._after=null});var u={_after:s,_on:[],info:{}};if(e.each(c,function(e,t){var a=t.info.after;if(a)if("step"===a)a=u;else if("prev"===a)a=c[e-1];else{var s=n(c,a,0,e-1);-1===s&&(s=n(c,a)),a=-1===s||s===e?c[e-1]:c[s]}else a=c[e-1];if(a){if(!t.info.delay){if(!a._after)return void(a._after=t);a=a._after}a._on.push({substep:t,delay:t.info.delay||0})}}),u._after===s&&0===u._on.length){var p=n(c,a.stepData.startSubstep)||0;u._after=c[p]}var f=[];do{var d=[{substep:u,delay:0}];i(d,u,0),f.push(d),u=null,e.each(d,o)}while(u);l.list=f,e(t).data("substepsData",l)}}),e.jmpress("unapplyStep",function(t){var a=e(t).data("substepsData");a&&e.each(a.list,function(t,a){e.each(a,function(t,a){a.substep.info.willClass&&e(a.substep.element).removeClass(a.substep.info.willClass),a.substep.info.hasClass&&e(a.substep.element).removeClass(a.substep.info.hasClass),a.substep.info.doClass&&e(a.substep.element).removeClass(a.substep.info.doClass)})})}),e.jmpress("setActive",function(t,a){var r=e(t).data("substepsData");if(r){a.substep===s&&(a.substep="prev"===a.reason?r.list.length-1:0);var n=a.substep;e.each(a.current.animationTimeouts,function(e,t){clearTimeout(t)}),a.current.animationTimeouts=[],e.each(r.list,function(t,s){var r=n>t,i=n>=t;e.each(s,function(t,s){function n(){e(s.substep.element).addClass(s.substep.info.doClass)}s.substep.info.hasClass&&e(s.substep.element)[(r?"add":"remove")+"Class"](s.substep.info.hasClass),i&&!r&&s.delay&&"prev"!==a.reason?s.substep.info.doClass&&(e(s.substep.element).removeClass(s.substep.info.doClass),a.current.animationTimeouts.push(setTimeout(n,s.delay))):s.substep.info.doClass&&e(s.substep.element)[(i?"add":"remove")+"Class"](s.substep.info.doClass)})})}}),e.jmpress("setInactive",function(t,a){function s(t){e.each(t.list,function(t,a){e.each(a,function(t,a){a.substep.info.hasClass&&e(a.substep.element).removeClass(a.substep.info.hasClass),a.substep.info.doClass&&e(a.substep.element).removeClass(a.substep.info.doClass)})})}if(a.nextStep!==t){e.each(a.current.animationCleanupWaiting,function(e,t){s(t)}),a.current.animationCleanupWaiting=[];var r=e(t).data("substepsData");r&&a.current.animationCleanupWaiting.push(r)}}),e.jmpress("selectNext",function(t,a){if(a.substep!==s){var r=e(t).data("substepsData");if(r)return a.substep<r.list.length-1?{step:t,substep:a.substep+1}:void 0}}),e.jmpress("selectPrev",function(t,a){if(a.substep!==s){var r=e(t).data("substepsData");if(r)return a.substep>0?{step:t,substep:a.substep-1}:void 0}})}(jQuery,document,window);